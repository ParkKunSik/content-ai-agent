{#
    [JSON 응답 포맷 규칙 모듈]
    
    설명:
    JSON 응답이 필요한 프롬프트에서 import하여 사용하는 공통 JSON 생성 규칙입니다.
    스키마 준수와 정확한 필드명 사용을 최우선으로 하며, 기존 메인 프롬프트의 
    '필수 JSON 생성 규칙'을 포괄하여 중복을 제거합니다.
    
    번역:
    **핵심 JSON 생성 규칙**:
    1. **정확한 스키마 준수**: 프롬프트에 명시된 JSON 스키마의 구조와 필드 이름을 정확하게 준수해야 함:
       - 필드명 정확히 일치 (대소문자 구분, 언더스코어, 하이픈 등 특수문자 포함)
       - 데이터 타입 정확히 일치 (문자열, 숫자, 배열, 객체 등)
       - 필수 필드 누락 금지
       - 추가 필드 생성 금지
       - 중첩 객체의 구조도 정확히 준수

    2. **문자열 Escape 처리**: 모든 문자열 값은 특수문자를 반드시 escape 처리해야 함:
       - 큰따옴표: `"` → `\"`
       - 백슬래시: `\` → `\\`
       - 줄바꿈: `\n` → `\\n` (또는 공백으로 대체)
       - 탭: `\t` → `\\t` (또는 공백으로 대체)
       - 캐리지 리턴: `\r` → `\\r` (또는 제거)

    3. **문자열 값에 줄바꿈 금지**: 모든 문자열 값을 한 줄로 유지

    4. **JSON 압축 형식**: 불필요한 공백, 줄바꿈, 들여쓰기 제거하여 minify된 형태로 출력 (프롬프트에 명시된 JSON 스키마 구조를 엄격히 준수)

    5. **유효한 JSON만**: 표준 JSON 파서로 파싱 가능하도록 보장

    6. **데이터 타입 정확성**: 
       - 숫자는 따옴표 없이 표기
       - 불린값은 true/false (따옴표 없음)
       - null 값은 null (따옴표 없음)
       - 배열과 객체는 적절한 대괄호/중괄호 사용

    번역 (json_response_rule):
    **핵심 JSON 출력 규칙**:
    1. **순수 JSON 객체**: 유효한 JSON 객체만 반환하십시오. 마크다운 코드 블록(예: ```json), 백틱, 또는 서론/결론 텍스트를 포함하지 마십시오.
    2. **스키마 무결성**: 제공된 JSON 스키마를 엄격히 준수하십시오. 모든 필드가 존재하고 데이터 타입이 정확히 일치해야 합니다.
    3. **적절한 Escape 처리**: 모든 문자열 값은 유효한 JSON을 위해 올바르게 escape되어야 합니다 (예: 따옴표는 \", 줄바꿈은 \n).
    4. **압축된 출력**: 불필요한 공백이나 들여쓰기 없이 압축된(minified) JSON 형식으로 결과를 제공하십시오.
#}

{% macro json_generation_rules() %}
**CRITICAL JSON Generation Rules**:
1. **Exact Schema Compliance**: MUST strictly follow the JSON schema structure and field names specified in the prompt:
   - Field names must match exactly (case-sensitive, including underscores, hyphens, and special characters)
   - Data types must match exactly (strings, numbers, arrays, objects, etc.)
   - Required fields must not be omitted
   - Additional fields must not be created
   - Nested object structures must be followed precisely

2. **String Escaping**: All string values MUST properly escape special characters:
   - Double quotes: `"` → `\"`
   - Backslashes: `\` → `\\`
   - Newlines: `\n` → `\\n` (or replace with space)
   - Tabs: `\t` → `\\t` (or replace with space)
   - Carriage returns: `\r` → `\\r` (or remove)

3. **No Line Breaks in String Values**: Keep all string values on a single line

4. **Minified JSON Format**: Remove unnecessary whitespace, line breaks, and indentation to produce compact minified JSON (strictly follow the JSON schema structure specified in the prompt)

5. **Valid JSON Only**: Ensure the output is parseable by standard JSON parsers

6. **Data Type Accuracy**: 
   - Numbers without quotes
   - Boolean values as true/false (without quotes)
   - null values as null (without quotes)
   - Arrays and objects with proper brackets/braces
{% endmacro %}

{% macro json_response_rule() %}
**CRITICAL JSON Output Rules**:
1. **Pure JSON Object**: Return ONLY a valid JSON object. Do NOT include markdown code blocks (e.g., ```json), backticks, or any preamble/postamble text.
2. **Schema Integrity**: Strictly adhere to the provided JSON schema. Ensure all fields are present and data types match exactly.
3. **Proper Escaping**: All string values must be correctly escaped for valid JSON (e.g., quotes as \", newlines as \n).
4. **Minified Output**: Provide the result in a compact, minified JSON format without unnecessary whitespace or indentation.
{% endmacro %}